<!DOCTYPE HTML>
<html>

<head>
    <title>An automated vehicle access management</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"
        integrity="sha256-yr4fRk/GU1ehYJPAs8P4JlTgu0Hdsp4ZKrx8bDEDC3I=" crossorigin="anonymous"></script>
    <script type="text/javascript" charset="utf-8">
        $(document).ready(function () {
            namespace = '/test';
            var socket = io(namespace);
            socket.on('connect', function () {
                socket.emit('my_event', { data: 'I\'m connected!' });
            });
            socket.on('my_response', function (msg, cb) {
                $('#log').empty();
                $('#log_vehicle_details').empty();
                $('#log').append('<br>' + $('<div/>').text('Received #' + msg.count + ': ' + msg.data).html());
                $('#log_vehicle_details').append('<br>' + $('<div/>').text('Received #' + msg.count + ': ' + msg.data).html());
                if (cb)
                    cb();
            });
            var ping_pong_times = [];
            var start_time;
            window.setInterval(function () {
                start_time = (new Date).getTime();
                socket.emit('my_ping');
            }, 1000);
            socket.on('my_pong', function () {
                var latency = (new Date).getTime() - start_time;
                ping_pong_times.push(latency);
                ping_pong_times = ping_pong_times.slice(-30); // keep last 30 samples
                var sum = 0;
                for (var i = 0; i < ping_pong_times.length; i++)
                    sum += ping_pong_times[i];
                $('#ping-pong').text(Math.round(10 * sum / ping_pong_times.length) / 10);
            });
            $('form#emit').submit(function (event) {
                socket.emit('my_event', { data: $('#emit_data').val() });
                return false;
            });
            $('form#broadcast').submit(function (event) {
                socket.emit('my_broadcast_event', { data: $('#broadcast_data').val() });
                return false;
            });
            $('form#join').submit(function (event) {
                socket.emit('join', { room: $('#join_room').val() });
                return false;
            });
            $('form#leave').submit(function (event) {
                socket.emit('leave', { room: $('#leave_room').val() });
                return false;
            });
            $('form#send_room').submit(function (event) {
                socket.emit('my_room_event', { room: $('#room_name').val(), data: $('#room_data').val() });
                return false;
            });
            $('form#close').submit(function (event) {
                socket.emit('close_room', { room: $('#close_room').val() });
                return false;
            });
            $('form#disconnect').submit(function (event) {
                socket.emit('disconnect_request');
                return false;
            });
        });
    </script>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col">
                <div class="alert alert-success" role="alert">
                    An automated vehicle access management and billing system for institutions
                  </div>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <h5>CHECKIN</h5>
                <div class="form-group">
                    <input type="text" name="emit_data" id="emit_data" placeholder="Name">
                </div>
                <div class="form-group">
                    <input type="text" name="broadcast_data" id="broadcast_data" placeholder="National ID">
                </div>
                <div class="form-group">
                    <input type="text" name="leave_room" id="leave_room" placeholder="Number Plate">
                </div>
                <div class="form-group">
                    <input type="submit" value="Submit">
                </div>
            </div>
            <div class="col">
                <h5>CHECKOUT</h5>
                <div class="form-group">
                    <input type="text" name="emit_data" id="emit_data" placeholder="Phone Number">
                </div>
                <div class="form-group">
                    <input type="submit" value="Submit">
                </div>
                <h4>Vehicle Details :</h4>
                <div id="log_vehicle_details"></div>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <h4>OCR NUMBER PLATE :</h4>
                <div id="log"></div>
            </div>
        </div>
    </div>

</body>

</html>