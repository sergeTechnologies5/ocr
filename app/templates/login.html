<!DOCTYPE HTML>
<html>

<head>
    <title>Smart Visitor</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"
        integrity="sha256-yr4fRk/GU1ehYJPAs8P4JlTgu0Hdsp4ZKrx8bDEDC3I=" crossorigin="anonymous"></script>
    <script type="text/javascript" charset="utf-8">
        $(document).ready(function () {
            namespace = '/test';
            var socket = io(namespace);
            socket.on('connect', function () {
                socket.emit('my_event', { data: 'I\'m connected!' });
            });
            socket.on('my_response', function (msg, cb) {
                $('#number_plate').val(msg.data)
                $('#log').empty()
                $('#log_vehicle_details').empty();
                $('#log').append('<br>' + $('<div/>').text('Received #' + msg.count + ': ' + msg.data).html());
                $('#log_vehicle_details').append('<br>' + $('<div/>').text('Received #' + msg.count + ': ' + msg.data).html());
                if (cb)
                    cb();
                
            });
            $( "#checkout_btn" ).click(function( event ) {
            // Stop form from submitting normally
            event.preventDefault();
            var number_plate = $( '#number_plate' ).val()

            url = 'http://192.168.0.102:5000/checkin'
            $.ajax({
                type: "POST",
                url: url,
                data: JSON.stringify({ number_plate:number_plate}),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function(data){
                    $( '#number_plate' ).empty()
                },
                error: function(errMsg) {
                    console.log('not ok')
            }});

            });
            
            // Attach a submit handler to the form
            $( "#checkinForm" ).click(function( event ) {
            // Stop form from submitting normally
            event.preventDefault();
            // Get some values from elements on the page:
            
            var emit_name = $( "#emit_name" ).val()
            var national_id = $( "#national_id" ).val()
            var number_plate = $( "#number_plate" ).val()
            var phone_number = $( "#phone_number" ).val()
            var purpose = $( "#purpose" ).val()
            var gender = $( "#gender" ).val()
            var department = $( "#department" ).val()
            url = 'http://192.168.0.102:5000/user'
            $.ajax({
                type: "POST",
                url: url,
                data: JSON.stringify({department:department,gender:gender,purpose:purpose,name:emit_name, national_id:national_id, number_plate:number_plate, phone_number:phone_number}),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function(data){
                    $( "#emit_name" ).empty()
                    $( "#national_id" ).empty()
                    $( "#number_plate" ).empty()
                    $( "#phone_number" ).empty()
                    $( "#purpose" ).empty()
                    $( "#gender" ).empty()
                    $( "#department" ).empty() 
                },
                error: function(errMsg) {
                    console.log('not ok')
            }});
            });

        });
    </script>
</head>

<body>
    <div class="container">
        <div class="row">

            <div class="col-md-10">
                <div class="alert alert-success" role="alert">
                An automated vehicle access management and billing system for institutions
                </div>
            </div>
            <div class="col-6 col-md-2"></div>
           
          </div>
        
          <div class="row">
            <div class="col-6">
                    <h5>CHECKIN</h5>
                    <div class="form-group">
                        <input type="text" name="emit_name" id="emit_name" placeholder="Name">
                    </div>
                    <div class="form-group">
                        <input type="text" name="national_id" id="national_id" placeholder="National ID">
                    </div>
                    <div class="form-group">
                        <input type="text" name="number_plate" id="number_plate" placeholder="Number Plate">
                    </div>
                    <div class="form-group">
                        <input type="text" name="phone_number" id="phone_number" placeholder="Phone Number">
                    </div>

                    <div class="form-group">
                        <input type="text" name="gender" id="gender" placeholder="Gender">
                    </div>
                    <div class="form-group">
                        <input type="text" name="department" id="department" placeholder="Department">
                    </div>
                    <div class="form-group">
                        <input type="text" name="purpose" id="purpose" placeholder="Purpose of Visit">
                    </div>

                    <div class="form-group">
                        <input id="checkinForm" type="submit" value="Submit">
                    </div>
                    <h5>OCR NUMBER PLATE :</h5>
                    <div id="log"></div>
            </div>
            <div class="col-6">
                    <h5>CHECKOUT</h5>
                    <div class="form-group">
                        <input type="text" name="number_plate" id="number_plate" placeholder="Plate Number">
                    </div>
                    <div class="form-group">
                        <input id="checkout_btn" type="submit" value="Submit">
                    </div>
                    <h4>Vehicle Details :</h4>
                    <div id="log_vehicle_details"></div>
            </div>
          </div>
    </div>

</body>

</html>